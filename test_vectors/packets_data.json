{
  "description": "Reticulum v1.1.3 - data packet and proof test vectors",
  "source": "RNS/Packet.py, RNS/Link.py, RNS/Destination.py",
  "constants": {
    "packet_types": {
      "DATA": 0,
      "PROOF": 3
    },
    "destination_types": {
      "LINK": 3
    },
    "context_types": {
      "NONE": 0
    },
    "proof_constants": {
      "EXPL_LENGTH": 96,
      "EXPL_LENGTH_note": "HASHLENGTH_BYTES(32) + SIGLENGTH_BYTES(64) = 96",
      "IMPL_LENGTH": 64,
      "IMPL_LENGTH_note": "SIGLENGTH_BYTES(64) = 64"
    },
    "link_mdu": 431,
    "link_mdu_derivation": "floor((MTU(500) - IFAC_MIN_SIZE(1) - HEADER_MINSIZE(19) - TOKEN_OVERHEAD(48)) / AES128_BLOCKSIZE(16)) * AES128_BLOCKSIZE(16) - 1 = 431",
    "data_packet_flags": "0c",
    "data_packet_flags_description": "HEADER_1 | FLAG_UNSET | BROADCAST | LINK | DATA",
    "proof_packet_flags": "0f",
    "proof_packet_flags_description": "HEADER_1 | FLAG_UNSET | BROADCAST | LINK | PROOF",
    "proof_not_encrypted_note": "PROOF packets over LINK destinations are NOT encrypted (Packet.py:198-200). self.ciphertext = self.data",
    "data_encrypted_note": "DATA packets over LINK destinations ARE encrypted via destination.encrypt() \u2192 Token(derived_key).encrypt()"
  },
  "proof_strategies": {
    "PROVE_NONE": {
      "value": 33,
      "hex": "0x21",
      "behavior": "Never generate proofs automatically. Application must explicitly call packet.prove()."
    },
    "PROVE_APP": {
      "value": 34,
      "hex": "0x22",
      "behavior": "Call the proof_requested callback. If it returns True, generate and send a proof."
    },
    "PROVE_ALL": {
      "value": 35,
      "hex": "0x23",
      "behavior": "Always generate and send proofs for all incoming packets automatically."
    },
    "proof_flow": [
      "1. Receiver gets a DATA packet over a link",
      "2. Check destination.proof_strategy",
      "3. If PROVE_NONE: do nothing",
      "4. If PROVE_APP: call proof_requested callback, prove if True",
      "5. If PROVE_ALL: always prove",
      "6. To prove: call link.prove_packet(packet)",
      "7. prove_packet computes: signature = link.sign(packet.packet_hash)",
      "8. proof_data = packet_hash(32) + signature(64) = 96 bytes (always explicit)",
      "9. Send proof as Packet(link, proof_data, PROOF) with context=NONE",
      "10. Proof packet is NOT encrypted (passthrough for PROOF on LINK)"
    ]
  },
  "receipt_states": {
    "FAILED": {
      "value": 0,
      "hex": "0x00",
      "description": "Proof not received within timeout period"
    },
    "SENT": {
      "value": 1,
      "hex": "0x01",
      "description": "Packet sent, awaiting proof"
    },
    "DELIVERED": {
      "value": 2,
      "hex": "0x02",
      "description": "Valid proof received, delivery confirmed"
    },
    "CULLED": {
      "value": 255,
      "hex": "0xff",
      "description": "Receipt culled (timeout set to -1)"
    }
  },
  "data_packet_vectors": [
    {
      "index": 0,
      "description": "Empty plaintext",
      "handshake_reference": "handshake_vectors[0] from links.json (keypair 0\u21921)",
      "link_id": "4daf0d8a4a8a3e0bfe8401b810467b22",
      "plaintext": "",
      "plaintext_length": 0,
      "deterministic_iv": "041e24d32600612e19f9dcef4f3863e1",
      "deterministic_iv_seed": "SHA256(b'reticulum_test_packet_data_iv_0')[:16]",
      "padded_plaintext": "10101010101010101010101010101010",
      "padded_plaintext_length": 16,
      "aes_ciphertext": "fe83daab4cac5ac1fb0c7f2df766af82",
      "aes_ciphertext_length": 16,
      "hmac": "84e788cf8310815e80317c41debd07860518d3d164dbaccc36b9b3279eedead5",
      "token_ciphertext": "041e24d32600612e19f9dcef4f3863e1fe83daab4cac5ac1fb0c7f2df766af8284e788cf8310815e80317c41debd07860518d3d164dbaccc36b9b3279eedead5",
      "token_ciphertext_length": 64,
      "token_layout": "IV(16) + AES_ciphertext(16) + HMAC(32) = 64",
      "flags_byte": "0c",
      "context_byte": "00",
      "raw_packet": "0c004daf0d8a4a8a3e0bfe8401b810467b2200041e24d32600612e19f9dcef4f3863e1fe83daab4cac5ac1fb0c7f2df766af8284e788cf8310815e80317c41debd07860518d3d164dbaccc36b9b3279eedead5",
      "raw_packet_length": 83,
      "hashable_part": "0c4daf0d8a4a8a3e0bfe8401b810467b2200041e24d32600612e19f9dcef4f3863e1fe83daab4cac5ac1fb0c7f2df766af8284e788cf8310815e80317c41debd07860518d3d164dbaccc36b9b3279eedead5",
      "packet_hash": "fc3d6d90f5f6e217b8079e2c931642dc7b2665e9a50ac1f803e69a1a693b85bf",
      "packet_hash_note": "Full 32-byte SHA-256 (not truncated)"
    },
    {
      "index": 1,
      "description": "Single byte 0x42",
      "handshake_reference": "handshake_vectors[0] from links.json (keypair 0\u21921)",
      "link_id": "4daf0d8a4a8a3e0bfe8401b810467b22",
      "plaintext": "42",
      "plaintext_length": 1,
      "deterministic_iv": "0fa4daa5a0d2bc3877b2067142770259",
      "deterministic_iv_seed": "SHA256(b'reticulum_test_packet_data_iv_1')[:16]",
      "padded_plaintext": "420f0f0f0f0f0f0f0f0f0f0f0f0f0f0f",
      "padded_plaintext_length": 16,
      "aes_ciphertext": "ab07bc7135c786d19c9c5ac8a129f6d9",
      "aes_ciphertext_length": 16,
      "hmac": "eafb3176a59ecd2496b2eab117270a77451366947095ee5be718bca6712fc601",
      "token_ciphertext": "0fa4daa5a0d2bc3877b2067142770259ab07bc7135c786d19c9c5ac8a129f6d9eafb3176a59ecd2496b2eab117270a77451366947095ee5be718bca6712fc601",
      "token_ciphertext_length": 64,
      "token_layout": "IV(16) + AES_ciphertext(16) + HMAC(32) = 64",
      "flags_byte": "0c",
      "context_byte": "00",
      "raw_packet": "0c004daf0d8a4a8a3e0bfe8401b810467b22000fa4daa5a0d2bc3877b2067142770259ab07bc7135c786d19c9c5ac8a129f6d9eafb3176a59ecd2496b2eab117270a77451366947095ee5be718bca6712fc601",
      "raw_packet_length": 83,
      "hashable_part": "0c4daf0d8a4a8a3e0bfe8401b810467b22000fa4daa5a0d2bc3877b2067142770259ab07bc7135c786d19c9c5ac8a129f6d9eafb3176a59ecd2496b2eab117270a77451366947095ee5be718bca6712fc601",
      "packet_hash": "0bc7c23c6654c3b601a63103c117a5ec65012c141c03f88a2f272a4e5e22e660",
      "packet_hash_note": "Full 32-byte SHA-256 (not truncated)"
    },
    {
      "index": 2,
      "description": "Hello, Reticulum! (17 bytes)",
      "handshake_reference": "handshake_vectors[0] from links.json (keypair 0\u21921)",
      "link_id": "4daf0d8a4a8a3e0bfe8401b810467b22",
      "plaintext": "48656c6c6f2c205265746963756c756d21",
      "plaintext_length": 17,
      "deterministic_iv": "ab7f2063bc1f06f8991698adbc1f214a",
      "deterministic_iv_seed": "SHA256(b'reticulum_test_packet_data_iv_2')[:16]",
      "padded_plaintext": "48656c6c6f2c205265746963756c756d210f0f0f0f0f0f0f0f0f0f0f0f0f0f0f",
      "padded_plaintext_length": 32,
      "aes_ciphertext": "603b43a84726a3022c6c459a040302df4d7415581b84f622ff74425054c6e78e",
      "aes_ciphertext_length": 32,
      "hmac": "ee6fe1231e202d6f1eec625709cc93eff860dea0cdb47a55899b1d23b52b7e6f",
      "token_ciphertext": "ab7f2063bc1f06f8991698adbc1f214a603b43a84726a3022c6c459a040302df4d7415581b84f622ff74425054c6e78eee6fe1231e202d6f1eec625709cc93eff860dea0cdb47a55899b1d23b52b7e6f",
      "token_ciphertext_length": 80,
      "token_layout": "IV(16) + AES_ciphertext(32) + HMAC(32) = 80",
      "flags_byte": "0c",
      "context_byte": "00",
      "raw_packet": "0c004daf0d8a4a8a3e0bfe8401b810467b2200ab7f2063bc1f06f8991698adbc1f214a603b43a84726a3022c6c459a040302df4d7415581b84f622ff74425054c6e78eee6fe1231e202d6f1eec625709cc93eff860dea0cdb47a55899b1d23b52b7e6f",
      "raw_packet_length": 99,
      "hashable_part": "0c4daf0d8a4a8a3e0bfe8401b810467b2200ab7f2063bc1f06f8991698adbc1f214a603b43a84726a3022c6c459a040302df4d7415581b84f622ff74425054c6e78eee6fe1231e202d6f1eec625709cc93eff860dea0cdb47a55899b1d23b52b7e6f",
      "packet_hash": "83567984c80908547b541966dc31a09ba1a4c476a9bd5752eee565e40b4f942b",
      "packet_hash_note": "Full 32-byte SHA-256 (not truncated)"
    },
    {
      "index": 3,
      "description": "Exact AES block (16 bytes of 0xAA)",
      "handshake_reference": "handshake_vectors[0] from links.json (keypair 0\u21921)",
      "link_id": "4daf0d8a4a8a3e0bfe8401b810467b22",
      "plaintext": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
      "plaintext_length": 16,
      "deterministic_iv": "55150136fb44dafce639192e361500a9",
      "deterministic_iv_seed": "SHA256(b'reticulum_test_packet_data_iv_3')[:16]",
      "padded_plaintext": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa10101010101010101010101010101010",
      "padded_plaintext_length": 32,
      "aes_ciphertext": "9a38dbde443cabd048eb5dd47240b9b566d76d94c0653a6fb338b868afd93db8",
      "aes_ciphertext_length": 32,
      "hmac": "69bec27d1fb47dc631bc4fa8c7a77066efb6a462e331d3d915fbf7a92eb25343",
      "token_ciphertext": "55150136fb44dafce639192e361500a99a38dbde443cabd048eb5dd47240b9b566d76d94c0653a6fb338b868afd93db869bec27d1fb47dc631bc4fa8c7a77066efb6a462e331d3d915fbf7a92eb25343",
      "token_ciphertext_length": 80,
      "token_layout": "IV(16) + AES_ciphertext(32) + HMAC(32) = 80",
      "flags_byte": "0c",
      "context_byte": "00",
      "raw_packet": "0c004daf0d8a4a8a3e0bfe8401b810467b220055150136fb44dafce639192e361500a99a38dbde443cabd048eb5dd47240b9b566d76d94c0653a6fb338b868afd93db869bec27d1fb47dc631bc4fa8c7a77066efb6a462e331d3d915fbf7a92eb25343",
      "raw_packet_length": 99,
      "hashable_part": "0c4daf0d8a4a8a3e0bfe8401b810467b220055150136fb44dafce639192e361500a99a38dbde443cabd048eb5dd47240b9b566d76d94c0653a6fb338b868afd93db869bec27d1fb47dc631bc4fa8c7a77066efb6a462e331d3d915fbf7a92eb25343",
      "packet_hash": "20122ddd5b42ee064f974c5ecabf01182ccdc89f5bf46c6caa946c583fb1b2c9",
      "packet_hash_note": "Full 32-byte SHA-256 (not truncated)"
    },
    {
      "index": 4,
      "description": "Full link MDU (431 bytes)",
      "handshake_reference": "handshake_vectors[0] from links.json (keypair 0\u21921)",
      "link_id": "4daf0d8a4a8a3e0bfe8401b810467b22",
      "plaintext": "000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9fa0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebfc0c1c2c3c4c5c6c7c8c9cacbcccdcecfd0d1d2d3d4d5d6d7d8d9dadbdcdddedfe0e1e2e3e4e5e6e7e8e9eaebecedeeeff0f1f2f3f4f5f6f7f8f9fafbfcfdfeff000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9fa0a1a2a3a4a5a6a7a8a9aaabacadae",
      "plaintext_length": 431,
      "deterministic_iv": "81b7ef6fde40439aeeeaa6fa84c3170c",
      "deterministic_iv_seed": "SHA256(b'reticulum_test_packet_data_iv_4')[:16]",
      "padded_plaintext": "000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9fa0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebfc0c1c2c3c4c5c6c7c8c9cacbcccdcecfd0d1d2d3d4d5d6d7d8d9dadbdcdddedfe0e1e2e3e4e5e6e7e8e9eaebecedeeeff0f1f2f3f4f5f6f7f8f9fafbfcfdfeff000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9fa0a1a2a3a4a5a6a7a8a9aaabacadae01",
      "padded_plaintext_length": 432,
      "aes_ciphertext": "1da33ab403ef33d2255b5fec82d83771e4419f0f562fa895fbd3843067850cfbb94e5cb30c27dc2513256b74b2d0f2dd22c133532c37f0644cf889468f08ae00e118b1b65a3fc1883c3b30891be4ef3d588f39a4cb8f0a5eca9117833808d394584b9f082802cb22abbd3571302b3c99084b14577df35e04a0fc577e603a6597f17dd78e73f1f2a062b0843a3d6964ee9f260bbb9cce7f07682f57941693d47e1d9d9006f5d022229e156eaaf408f10522c8f579fc68105c7e9a5a6c49ceda15617cb84153749dc8f01108044363d151c384a17ef8a885d1ab3825e2bdb1e3ba6fec2ae52167336fe77c4afa297997b27850a7f42ecb9948106dc52bac3d8c21af9937b014bb7b1f973651e431727e80a5247e3ce3802eb255ea69757826e18dca781f25a9df932cd62652596f23494152a9cd29125f5d7d0df731c5d9433b6efb00500f225ea514d7c4df2f6fd2ba4a28766fdde047c2137d78656c3fc4e189edb206be5bd978ed73b847611d8bdfb8d456a7e47a8b28f5bd596b306ff31c35aeabdc1760ccbd72c5aaa732f13750871f9c325c84d262026f457f327f9e302f9e77747a60dfb928bb85adc89af45e31",
      "aes_ciphertext_length": 432,
      "hmac": "e173231d2a56edbb29dfe349f72a73eb2e31ce0b83d01e654843fe22ea4673b3",
      "token_ciphertext": "81b7ef6fde40439aeeeaa6fa84c3170c1da33ab403ef33d2255b5fec82d83771e4419f0f562fa895fbd3843067850cfbb94e5cb30c27dc2513256b74b2d0f2dd22c133532c37f0644cf889468f08ae00e118b1b65a3fc1883c3b30891be4ef3d588f39a4cb8f0a5eca9117833808d394584b9f082802cb22abbd3571302b3c99084b14577df35e04a0fc577e603a6597f17dd78e73f1f2a062b0843a3d6964ee9f260bbb9cce7f07682f57941693d47e1d9d9006f5d022229e156eaaf408f10522c8f579fc68105c7e9a5a6c49ceda15617cb84153749dc8f01108044363d151c384a17ef8a885d1ab3825e2bdb1e3ba6fec2ae52167336fe77c4afa297997b27850a7f42ecb9948106dc52bac3d8c21af9937b014bb7b1f973651e431727e80a5247e3ce3802eb255ea69757826e18dca781f25a9df932cd62652596f23494152a9cd29125f5d7d0df731c5d9433b6efb00500f225ea514d7c4df2f6fd2ba4a28766fdde047c2137d78656c3fc4e189edb206be5bd978ed73b847611d8bdfb8d456a7e47a8b28f5bd596b306ff31c35aeabdc1760ccbd72c5aaa732f13750871f9c325c84d262026f457f327f9e302f9e77747a60dfb928bb85adc89af45e31e173231d2a56edbb29dfe349f72a73eb2e31ce0b83d01e654843fe22ea4673b3",
      "token_ciphertext_length": 480,
      "token_layout": "IV(16) + AES_ciphertext(432) + HMAC(32) = 480",
      "flags_byte": "0c",
      "context_byte": "00",
      "raw_packet": "0c004daf0d8a4a8a3e0bfe8401b810467b220081b7ef6fde40439aeeeaa6fa84c3170c1da33ab403ef33d2255b5fec82d83771e4419f0f562fa895fbd3843067850cfbb94e5cb30c27dc2513256b74b2d0f2dd22c133532c37f0644cf889468f08ae00e118b1b65a3fc1883c3b30891be4ef3d588f39a4cb8f0a5eca9117833808d394584b9f082802cb22abbd3571302b3c99084b14577df35e04a0fc577e603a6597f17dd78e73f1f2a062b0843a3d6964ee9f260bbb9cce7f07682f57941693d47e1d9d9006f5d022229e156eaaf408f10522c8f579fc68105c7e9a5a6c49ceda15617cb84153749dc8f01108044363d151c384a17ef8a885d1ab3825e2bdb1e3ba6fec2ae52167336fe77c4afa297997b27850a7f42ecb9948106dc52bac3d8c21af9937b014bb7b1f973651e431727e80a5247e3ce3802eb255ea69757826e18dca781f25a9df932cd62652596f23494152a9cd29125f5d7d0df731c5d9433b6efb00500f225ea514d7c4df2f6fd2ba4a28766fdde047c2137d78656c3fc4e189edb206be5bd978ed73b847611d8bdfb8d456a7e47a8b28f5bd596b306ff31c35aeabdc1760ccbd72c5aaa732f13750871f9c325c84d262026f457f327f9e302f9e77747a60dfb928bb85adc89af45e31e173231d2a56edbb29dfe349f72a73eb2e31ce0b83d01e654843fe22ea4673b3",
      "raw_packet_length": 499,
      "hashable_part": "0c4daf0d8a4a8a3e0bfe8401b810467b220081b7ef6fde40439aeeeaa6fa84c3170c1da33ab403ef33d2255b5fec82d83771e4419f0f562fa895fbd3843067850cfbb94e5cb30c27dc2513256b74b2d0f2dd22c133532c37f0644cf889468f08ae00e118b1b65a3fc1883c3b30891be4ef3d588f39a4cb8f0a5eca9117833808d394584b9f082802cb22abbd3571302b3c99084b14577df35e04a0fc577e603a6597f17dd78e73f1f2a062b0843a3d6964ee9f260bbb9cce7f07682f57941693d47e1d9d9006f5d022229e156eaaf408f10522c8f579fc68105c7e9a5a6c49ceda15617cb84153749dc8f01108044363d151c384a17ef8a885d1ab3825e2bdb1e3ba6fec2ae52167336fe77c4afa297997b27850a7f42ecb9948106dc52bac3d8c21af9937b014bb7b1f973651e431727e80a5247e3ce3802eb255ea69757826e18dca781f25a9df932cd62652596f23494152a9cd29125f5d7d0df731c5d9433b6efb00500f225ea514d7c4df2f6fd2ba4a28766fdde047c2137d78656c3fc4e189edb206be5bd978ed73b847611d8bdfb8d456a7e47a8b28f5bd596b306ff31c35aeabdc1760ccbd72c5aaa732f13750871f9c325c84d262026f457f327f9e302f9e77747a60dfb928bb85adc89af45e31e173231d2a56edbb29dfe349f72a73eb2e31ce0b83d01e654843fe22ea4673b3",
      "packet_hash": "af3402846379e695f8988cc0fd61110edc17bd3be5342acf59f6f5aa2db67a69",
      "packet_hash_note": "Full 32-byte SHA-256 (not truncated)"
    }
  ],
  "proof_generation_vectors": [
    {
      "data_packet_index": 0,
      "description": "Proof for data packet 0: Empty plaintext",
      "link_id": "4daf0d8a4a8a3e0bfe8401b810467b22",
      "original_packet_hash": "fc3d6d90f5f6e217b8079e2c931642dc7b2665e9a50ac1f803e69a1a693b85bf",
      "signer": "responder_identity_ed25519",
      "signer_private_key": "0ebf8f926abf628da9d92baaa12db89bd6516ee92ec29765f3afafcb8622d697",
      "signer_note": "Responder signs with identity Ed25519 private key (Link.py:279: self.sig_prv = self.owner.identity.sig_prv)",
      "signature": "a2bfe58dcf4df7b6cff2f25166781f943c465f9ffb73bf7cab5cdb32345f32a34551231c62963897f14a7013b983e92240b2b3d98262878fe8f9f680f3984505",
      "signature_length": 64,
      "proof_data": "fc3d6d90f5f6e217b8079e2c931642dc7b2665e9a50ac1f803e69a1a693b85bfa2bfe58dcf4df7b6cff2f25166781f943c465f9ffb73bf7cab5cdb32345f32a34551231c62963897f14a7013b983e92240b2b3d98262878fe8f9f680f3984505",
      "proof_data_length": 96,
      "proof_data_layout": "packet_hash(32) + signature(64) = 96 bytes (explicit proof)",
      "not_encrypted": true,
      "not_encrypted_note": "Proof packets over LINK destinations skip encryption (Packet.py:198-200)",
      "flags_byte": "0f",
      "context_byte": "00",
      "context_note": "prove_packet() creates Packet(self, proof_data, PROOF) with default context=NONE",
      "raw_proof_packet": "0f004daf0d8a4a8a3e0bfe8401b810467b2200fc3d6d90f5f6e217b8079e2c931642dc7b2665e9a50ac1f803e69a1a693b85bfa2bfe58dcf4df7b6cff2f25166781f943c465f9ffb73bf7cab5cdb32345f32a34551231c62963897f14a7013b983e92240b2b3d98262878fe8f9f680f3984505",
      "raw_proof_packet_length": 115,
      "proof_packet_hash": "3bf81d97d3be36a46bb83904751e2d28a2a66a40e41808fee9f84e11f9584df1"
    },
    {
      "data_packet_index": 1,
      "description": "Proof for data packet 1: Single byte 0x42",
      "link_id": "4daf0d8a4a8a3e0bfe8401b810467b22",
      "original_packet_hash": "0bc7c23c6654c3b601a63103c117a5ec65012c141c03f88a2f272a4e5e22e660",
      "signer": "responder_identity_ed25519",
      "signer_private_key": "0ebf8f926abf628da9d92baaa12db89bd6516ee92ec29765f3afafcb8622d697",
      "signer_note": "Responder signs with identity Ed25519 private key (Link.py:279: self.sig_prv = self.owner.identity.sig_prv)",
      "signature": "971ce6553f3018bf1e999031b543d7ad72e80f19d9e9430262d70e7ca0fcbf0f1bb7373ed8e31a2313f0f76558dc7c10a7d3d01209e217f95081b211971b500f",
      "signature_length": 64,
      "proof_data": "0bc7c23c6654c3b601a63103c117a5ec65012c141c03f88a2f272a4e5e22e660971ce6553f3018bf1e999031b543d7ad72e80f19d9e9430262d70e7ca0fcbf0f1bb7373ed8e31a2313f0f76558dc7c10a7d3d01209e217f95081b211971b500f",
      "proof_data_length": 96,
      "proof_data_layout": "packet_hash(32) + signature(64) = 96 bytes (explicit proof)",
      "not_encrypted": true,
      "not_encrypted_note": "Proof packets over LINK destinations skip encryption (Packet.py:198-200)",
      "flags_byte": "0f",
      "context_byte": "00",
      "context_note": "prove_packet() creates Packet(self, proof_data, PROOF) with default context=NONE",
      "raw_proof_packet": "0f004daf0d8a4a8a3e0bfe8401b810467b22000bc7c23c6654c3b601a63103c117a5ec65012c141c03f88a2f272a4e5e22e660971ce6553f3018bf1e999031b543d7ad72e80f19d9e9430262d70e7ca0fcbf0f1bb7373ed8e31a2313f0f76558dc7c10a7d3d01209e217f95081b211971b500f",
      "raw_proof_packet_length": 115,
      "proof_packet_hash": "959972d48fb53fae8852faf388e0e689c40c8f534daf817ab8d33448651b1660"
    },
    {
      "data_packet_index": 2,
      "description": "Proof for data packet 2: Hello, Reticulum! (17 bytes)",
      "link_id": "4daf0d8a4a8a3e0bfe8401b810467b22",
      "original_packet_hash": "83567984c80908547b541966dc31a09ba1a4c476a9bd5752eee565e40b4f942b",
      "signer": "responder_identity_ed25519",
      "signer_private_key": "0ebf8f926abf628da9d92baaa12db89bd6516ee92ec29765f3afafcb8622d697",
      "signer_note": "Responder signs with identity Ed25519 private key (Link.py:279: self.sig_prv = self.owner.identity.sig_prv)",
      "signature": "7f3a016a9e8bc251141d754d9844771c126c733fefd76acf3df05bfa48bca42e1305b1a2c56b694afa3c5c9fda4d4cc90810a125c49eebc4ee6aff777efc6908",
      "signature_length": 64,
      "proof_data": "83567984c80908547b541966dc31a09ba1a4c476a9bd5752eee565e40b4f942b7f3a016a9e8bc251141d754d9844771c126c733fefd76acf3df05bfa48bca42e1305b1a2c56b694afa3c5c9fda4d4cc90810a125c49eebc4ee6aff777efc6908",
      "proof_data_length": 96,
      "proof_data_layout": "packet_hash(32) + signature(64) = 96 bytes (explicit proof)",
      "not_encrypted": true,
      "not_encrypted_note": "Proof packets over LINK destinations skip encryption (Packet.py:198-200)",
      "flags_byte": "0f",
      "context_byte": "00",
      "context_note": "prove_packet() creates Packet(self, proof_data, PROOF) with default context=NONE",
      "raw_proof_packet": "0f004daf0d8a4a8a3e0bfe8401b810467b220083567984c80908547b541966dc31a09ba1a4c476a9bd5752eee565e40b4f942b7f3a016a9e8bc251141d754d9844771c126c733fefd76acf3df05bfa48bca42e1305b1a2c56b694afa3c5c9fda4d4cc90810a125c49eebc4ee6aff777efc6908",
      "raw_proof_packet_length": 115,
      "proof_packet_hash": "3744b1d131dd4bd19e70303fd25275312440dff6f401008a6a7fdbba7fb7fb4b"
    },
    {
      "data_packet_index": 3,
      "description": "Proof for data packet 3: Exact AES block (16 bytes of 0xAA)",
      "link_id": "4daf0d8a4a8a3e0bfe8401b810467b22",
      "original_packet_hash": "20122ddd5b42ee064f974c5ecabf01182ccdc89f5bf46c6caa946c583fb1b2c9",
      "signer": "responder_identity_ed25519",
      "signer_private_key": "0ebf8f926abf628da9d92baaa12db89bd6516ee92ec29765f3afafcb8622d697",
      "signer_note": "Responder signs with identity Ed25519 private key (Link.py:279: self.sig_prv = self.owner.identity.sig_prv)",
      "signature": "5ab38a7002d68ab0c4dab1d5d77dc93b9523542780f8a7af58da015458b340ed0209db79539b4fa284bc26236accd262cc79b0425c1bb66dca1a04b430936a08",
      "signature_length": 64,
      "proof_data": "20122ddd5b42ee064f974c5ecabf01182ccdc89f5bf46c6caa946c583fb1b2c95ab38a7002d68ab0c4dab1d5d77dc93b9523542780f8a7af58da015458b340ed0209db79539b4fa284bc26236accd262cc79b0425c1bb66dca1a04b430936a08",
      "proof_data_length": 96,
      "proof_data_layout": "packet_hash(32) + signature(64) = 96 bytes (explicit proof)",
      "not_encrypted": true,
      "not_encrypted_note": "Proof packets over LINK destinations skip encryption (Packet.py:198-200)",
      "flags_byte": "0f",
      "context_byte": "00",
      "context_note": "prove_packet() creates Packet(self, proof_data, PROOF) with default context=NONE",
      "raw_proof_packet": "0f004daf0d8a4a8a3e0bfe8401b810467b220020122ddd5b42ee064f974c5ecabf01182ccdc89f5bf46c6caa946c583fb1b2c95ab38a7002d68ab0c4dab1d5d77dc93b9523542780f8a7af58da015458b340ed0209db79539b4fa284bc26236accd262cc79b0425c1bb66dca1a04b430936a08",
      "raw_proof_packet_length": 115,
      "proof_packet_hash": "b65415ca1cc42357db32c77de6fbbfdf90ee5632ee854d895346015be37e8607"
    },
    {
      "data_packet_index": 4,
      "description": "Proof for data packet 4: Full link MDU (431 bytes)",
      "link_id": "4daf0d8a4a8a3e0bfe8401b810467b22",
      "original_packet_hash": "af3402846379e695f8988cc0fd61110edc17bd3be5342acf59f6f5aa2db67a69",
      "signer": "responder_identity_ed25519",
      "signer_private_key": "0ebf8f926abf628da9d92baaa12db89bd6516ee92ec29765f3afafcb8622d697",
      "signer_note": "Responder signs with identity Ed25519 private key (Link.py:279: self.sig_prv = self.owner.identity.sig_prv)",
      "signature": "ad807926365a257cac47a1bd56bc60d4530d9a5d143d1d00d4b0f54867508f46bad3055277e3c286d99f2e58e7e2695964dcc85f07e7b1b0dae07ca047c3a507",
      "signature_length": 64,
      "proof_data": "af3402846379e695f8988cc0fd61110edc17bd3be5342acf59f6f5aa2db67a69ad807926365a257cac47a1bd56bc60d4530d9a5d143d1d00d4b0f54867508f46bad3055277e3c286d99f2e58e7e2695964dcc85f07e7b1b0dae07ca047c3a507",
      "proof_data_length": 96,
      "proof_data_layout": "packet_hash(32) + signature(64) = 96 bytes (explicit proof)",
      "not_encrypted": true,
      "not_encrypted_note": "Proof packets over LINK destinations skip encryption (Packet.py:198-200)",
      "flags_byte": "0f",
      "context_byte": "00",
      "context_note": "prove_packet() creates Packet(self, proof_data, PROOF) with default context=NONE",
      "raw_proof_packet": "0f004daf0d8a4a8a3e0bfe8401b810467b2200af3402846379e695f8988cc0fd61110edc17bd3be5342acf59f6f5aa2db67a69ad807926365a257cac47a1bd56bc60d4530d9a5d143d1d00d4b0f54867508f46bad3055277e3c286d99f2e58e7e2695964dcc85f07e7b1b0dae07ca047c3a507",
      "raw_proof_packet_length": 115,
      "proof_packet_hash": "172ee0780bc18a5d71ee52722ddd94ee1efa0b56294fec3a0ad08cf6ee4d98a1"
    }
  ],
  "proof_validation_vectors": [
    {
      "data_packet_index": 0,
      "description": "Validate proof for data packet 0",
      "proof_data": "fc3d6d90f5f6e217b8079e2c931642dc7b2665e9a50ac1f803e69a1a693b85bfa2bfe58dcf4df7b6cff2f25166781f943c465f9ffb73bf7cab5cdb32345f32a34551231c62963897f14a7013b983e92240b2b3d98262878fe8f9f680f3984505",
      "proof_hash_extracted": "fc3d6d90f5f6e217b8079e2c931642dc7b2665e9a50ac1f803e69a1a693b85bf",
      "signature_extracted": "a2bfe58dcf4df7b6cff2f25166781f943c465f9ffb73bf7cab5cdb32345f32a34551231c62963897f14a7013b983e92240b2b3d98262878fe8f9f680f3984505",
      "validator_public_key": "96103b09e36c0fb83596fb2a6139075d6510236e6a86129cfc1fd403f74c5b11",
      "validator_note": "Initiator validates with peer_sig_pub = responder's identity Ed25519 public key (Link.py:412)",
      "step_1_hash_match": true,
      "step_2_signature_valid": true,
      "expected_receipt_status": "DELIVERED",
      "expected_receipt_status_value": 2
    },
    {
      "data_packet_index": 1,
      "description": "Validate proof for data packet 1",
      "proof_data": "0bc7c23c6654c3b601a63103c117a5ec65012c141c03f88a2f272a4e5e22e660971ce6553f3018bf1e999031b543d7ad72e80f19d9e9430262d70e7ca0fcbf0f1bb7373ed8e31a2313f0f76558dc7c10a7d3d01209e217f95081b211971b500f",
      "proof_hash_extracted": "0bc7c23c6654c3b601a63103c117a5ec65012c141c03f88a2f272a4e5e22e660",
      "signature_extracted": "971ce6553f3018bf1e999031b543d7ad72e80f19d9e9430262d70e7ca0fcbf0f1bb7373ed8e31a2313f0f76558dc7c10a7d3d01209e217f95081b211971b500f",
      "validator_public_key": "96103b09e36c0fb83596fb2a6139075d6510236e6a86129cfc1fd403f74c5b11",
      "validator_note": "Initiator validates with peer_sig_pub = responder's identity Ed25519 public key (Link.py:412)",
      "step_1_hash_match": true,
      "step_2_signature_valid": true,
      "expected_receipt_status": "DELIVERED",
      "expected_receipt_status_value": 2
    },
    {
      "data_packet_index": 2,
      "description": "Validate proof for data packet 2",
      "proof_data": "83567984c80908547b541966dc31a09ba1a4c476a9bd5752eee565e40b4f942b7f3a016a9e8bc251141d754d9844771c126c733fefd76acf3df05bfa48bca42e1305b1a2c56b694afa3c5c9fda4d4cc90810a125c49eebc4ee6aff777efc6908",
      "proof_hash_extracted": "83567984c80908547b541966dc31a09ba1a4c476a9bd5752eee565e40b4f942b",
      "signature_extracted": "7f3a016a9e8bc251141d754d9844771c126c733fefd76acf3df05bfa48bca42e1305b1a2c56b694afa3c5c9fda4d4cc90810a125c49eebc4ee6aff777efc6908",
      "validator_public_key": "96103b09e36c0fb83596fb2a6139075d6510236e6a86129cfc1fd403f74c5b11",
      "validator_note": "Initiator validates with peer_sig_pub = responder's identity Ed25519 public key (Link.py:412)",
      "step_1_hash_match": true,
      "step_2_signature_valid": true,
      "expected_receipt_status": "DELIVERED",
      "expected_receipt_status_value": 2
    },
    {
      "data_packet_index": 3,
      "description": "Validate proof for data packet 3",
      "proof_data": "20122ddd5b42ee064f974c5ecabf01182ccdc89f5bf46c6caa946c583fb1b2c95ab38a7002d68ab0c4dab1d5d77dc93b9523542780f8a7af58da015458b340ed0209db79539b4fa284bc26236accd262cc79b0425c1bb66dca1a04b430936a08",
      "proof_hash_extracted": "20122ddd5b42ee064f974c5ecabf01182ccdc89f5bf46c6caa946c583fb1b2c9",
      "signature_extracted": "5ab38a7002d68ab0c4dab1d5d77dc93b9523542780f8a7af58da015458b340ed0209db79539b4fa284bc26236accd262cc79b0425c1bb66dca1a04b430936a08",
      "validator_public_key": "96103b09e36c0fb83596fb2a6139075d6510236e6a86129cfc1fd403f74c5b11",
      "validator_note": "Initiator validates with peer_sig_pub = responder's identity Ed25519 public key (Link.py:412)",
      "step_1_hash_match": true,
      "step_2_signature_valid": true,
      "expected_receipt_status": "DELIVERED",
      "expected_receipt_status_value": 2
    },
    {
      "data_packet_index": 4,
      "description": "Validate proof for data packet 4",
      "proof_data": "af3402846379e695f8988cc0fd61110edc17bd3be5342acf59f6f5aa2db67a69ad807926365a257cac47a1bd56bc60d4530d9a5d143d1d00d4b0f54867508f46bad3055277e3c286d99f2e58e7e2695964dcc85f07e7b1b0dae07ca047c3a507",
      "proof_hash_extracted": "af3402846379e695f8988cc0fd61110edc17bd3be5342acf59f6f5aa2db67a69",
      "signature_extracted": "ad807926365a257cac47a1bd56bc60d4530d9a5d143d1d00d4b0f54867508f46bad3055277e3c286d99f2e58e7e2695964dcc85f07e7b1b0dae07ca047c3a507",
      "validator_public_key": "96103b09e36c0fb83596fb2a6139075d6510236e6a86129cfc1fd403f74c5b11",
      "validator_note": "Initiator validates with peer_sig_pub = responder's identity Ed25519 public key (Link.py:412)",
      "step_1_hash_match": true,
      "step_2_signature_valid": true,
      "expected_receipt_status": "DELIVERED",
      "expected_receipt_status_value": 2
    }
  ],
  "invalid_proof_vectors": [
    {
      "description": "Invalid proof: tampered hash (first byte flipped)",
      "data_packet_index": 0,
      "original_packet_hash": "fc3d6d90f5f6e217b8079e2c931642dc7b2665e9a50ac1f803e69a1a693b85bf",
      "tampered_proof_data": "033d6d90f5f6e217b8079e2c931642dc7b2665e9a50ac1f803e69a1a693b85bfa2bfe58dcf4df7b6cff2f25166781f943c465f9ffb73bf7cab5cdb32345f32a34551231c62963897f14a7013b983e92240b2b3d98262878fe8f9f680f3984505",
      "tampered_proof_hash": "033d6d90f5f6e217b8079e2c931642dc7b2665e9a50ac1f803e69a1a693b85bf",
      "signature": "a2bfe58dcf4df7b6cff2f25166781f943c465f9ffb73bf7cab5cdb32345f32a34551231c62963897f14a7013b983e92240b2b3d98262878fe8f9f680f3984505",
      "failure_reason": "proof_hash != original_packet_hash (hash mismatch, fails at step 1)",
      "hash_match": false,
      "signature_check_reached": false,
      "expected_result": false
    },
    {
      "description": "Invalid proof: tampered signature (first byte flipped)",
      "data_packet_index": 0,
      "original_packet_hash": "fc3d6d90f5f6e217b8079e2c931642dc7b2665e9a50ac1f803e69a1a693b85bf",
      "tampered_proof_data": "fc3d6d90f5f6e217b8079e2c931642dc7b2665e9a50ac1f803e69a1a693b85bf5dbfe58dcf4df7b6cff2f25166781f943c465f9ffb73bf7cab5cdb32345f32a34551231c62963897f14a7013b983e92240b2b3d98262878fe8f9f680f3984505",
      "proof_hash": "fc3d6d90f5f6e217b8079e2c931642dc7b2665e9a50ac1f803e69a1a693b85bf",
      "tampered_signature": "5dbfe58dcf4df7b6cff2f25166781f943c465f9ffb73bf7cab5cdb32345f32a34551231c62963897f14a7013b983e92240b2b3d98262878fe8f9f680f3984505",
      "failure_reason": "Ed25519 signature verification fails (valid hash, invalid signature)",
      "hash_match": true,
      "signature_check_reached": true,
      "signature_valid": false,
      "expected_result": false
    },
    {
      "description": "Invalid proof: signed with wrong key (keypair[2] instead of responder keypair[1])",
      "data_packet_index": 0,
      "original_packet_hash": "fc3d6d90f5f6e217b8079e2c931642dc7b2665e9a50ac1f803e69a1a693b85bf",
      "wrong_key_proof_data": "fc3d6d90f5f6e217b8079e2c931642dc7b2665e9a50ac1f803e69a1a693b85bf6be2aaeff32d8650cd74daea5cb9fc871f68d4bc1f9779c024c5c268f6817d4b54f0631e8b0ac182ef2a47acf78fe3ef5e36a650374eb6f0fefe734f35af2f0a",
      "proof_hash": "fc3d6d90f5f6e217b8079e2c931642dc7b2665e9a50ac1f803e69a1a693b85bf",
      "wrong_signature": "6be2aaeff32d8650cd74daea5cb9fc871f68d4bc1f9779c024c5c268f6817d4b54f0631e8b0ac182ef2a47acf78fe3ef5e36a650374eb6f0fefe734f35af2f0a",
      "wrong_signer_keypair_index": 2,
      "wrong_signer_ed25519_public": "10e7d32e2d67aeb316515de2ee77e7097777b80edfe3b9173db0f5de320b88a2",
      "failure_reason": "Signature valid for wrong key, fails verification with correct peer_sig_pub",
      "hash_match": true,
      "signature_check_reached": true,
      "signature_valid_with_correct_key": false,
      "signature_valid_with_wrong_key": true,
      "expected_result": false
    }
  ],
  "bidirectional_vectors": {
    "description": "Bidirectional data+proof vectors demonstrating asymmetric signing keys",
    "encryption_note": "Encryption is symmetric \u2014 both directions use the same derived_key/Token",
    "signing_note": "Signing is asymmetric \u2014 responder uses identity Ed25519, initiator uses ephemeral Ed25519",
    "link_id": "4daf0d8a4a8a3e0bfe8401b810467b22",
    "derived_key": "46b2978d613a03932e701caeb7288d7c12462c5be455c0e133f8ffcd0d35e9091dad7ff512ee502aea792e2db89de23cd488eb5dbb505f9be32cb706b655d1d4",
    "vectors": [
      {
        "direction": "initiator_to_responder",
        "description": "Initiator sends DATA, responder generates proof (signs with identity Ed25519)",
        "plaintext": "696e69746961746f7220746f20726573706f6e646572",
        "deterministic_iv": "03d600dcf699d05f919d56beaa7429ef",
        "token_ciphertext": "03d600dcf699d05f919d56beaa7429ef7d186ae3fcfdc50f55fc919a36b8fcab24a13bb803066325ddab24ed5fbe1ec89b25d3a1ed33a831d5d45e6a9ad53cf116660e5f4cc0033680ffed5bc7fb0c45",
        "raw_data_packet": "0c004daf0d8a4a8a3e0bfe8401b810467b220003d600dcf699d05f919d56beaa7429ef7d186ae3fcfdc50f55fc919a36b8fcab24a13bb803066325ddab24ed5fbe1ec89b25d3a1ed33a831d5d45e6a9ad53cf116660e5f4cc0033680ffed5bc7fb0c45",
        "packet_hash": "0aa0177fa241078f6c56c2371b1f8f5c70276cb4da0e6c4d812c34ea5932d8d6",
        "proof_signer": "responder_identity_ed25519",
        "proof_signer_private": "0ebf8f926abf628da9d92baaa12db89bd6516ee92ec29765f3afafcb8622d697",
        "proof_signer_note": "Link.py:279 \u2014 responder: self.sig_prv = self.owner.identity.sig_prv",
        "proof_signature": "2242aeea2cc0c03560ac40eef37c851238beb7375977f73173277ece8c9ca7cfc53ffe4aa77cf27640e36f10c8f1f60f4ac85018d2519c0fc542ad8c8c72410b",
        "proof_data": "0aa0177fa241078f6c56c2371b1f8f5c70276cb4da0e6c4d812c34ea5932d8d62242aeea2cc0c03560ac40eef37c851238beb7375977f73173277ece8c9ca7cfc53ffe4aa77cf27640e36f10c8f1f60f4ac85018d2519c0fc542ad8c8c72410b",
        "raw_proof_packet": "0f004daf0d8a4a8a3e0bfe8401b810467b22000aa0177fa241078f6c56c2371b1f8f5c70276cb4da0e6c4d812c34ea5932d8d62242aeea2cc0c03560ac40eef37c851238beb7375977f73173277ece8c9ca7cfc53ffe4aa77cf27640e36f10c8f1f60f4ac85018d2519c0fc542ad8c8c72410b",
        "proof_validator_public": "96103b09e36c0fb83596fb2a6139075d6510236e6a86129cfc1fd403f74c5b11",
        "proof_validator_note": "Link.py:412 \u2014 initiator: peer_sig_pub = destination.identity.get_public_key()[32:64] (responder identity Ed25519 pub)"
      },
      {
        "direction": "responder_to_initiator",
        "description": "Responder sends DATA, initiator generates proof (signs with ephemeral Ed25519)",
        "plaintext": "726573706f6e64657220746f20696e69746961746f72",
        "deterministic_iv": "f63019db835cc5c4f2c956ba2ecf89f0",
        "token_ciphertext": "f63019db835cc5c4f2c956ba2ecf89f05727fdbb3943d4321690b583fb5f55109d5156822f5dd689a1c648d960a862f829ccd4efaeacc85d33f60dc6ca430c74c2b3bc593306850f5a66e86bb9015055",
        "raw_data_packet": "0c004daf0d8a4a8a3e0bfe8401b810467b2200f63019db835cc5c4f2c956ba2ecf89f05727fdbb3943d4321690b583fb5f55109d5156822f5dd689a1c648d960a862f829ccd4efaeacc85d33f60dc6ca430c74c2b3bc593306850f5a66e86bb9015055",
        "packet_hash": "45fc27c6344f0c9623feb75d6faad0b878a7536b1383464b02c130ac4318e392",
        "proof_signer": "initiator_ephemeral_ed25519",
        "proof_signer_private": "5cf3c3a428d92c8b31d2bf5cb3163cebfc0862de36cfc0cb81aaf7c36cd71539",
        "proof_signer_note": "Link.py:286 \u2014 initiator: self.sig_prv = Ed25519PrivateKey.generate() (ephemeral, sent in LINKREQUEST)",
        "proof_signature": "c799add39bca6893459f0f7e781759bf70c2464e1c37ec18a40b460e97a5f1a9ec94c6e2dcfeeaa8ca5d20a5b26315e899e0d22dcf0aa8dbac19f6820f21cf0f",
        "proof_data": "45fc27c6344f0c9623feb75d6faad0b878a7536b1383464b02c130ac4318e392c799add39bca6893459f0f7e781759bf70c2464e1c37ec18a40b460e97a5f1a9ec94c6e2dcfeeaa8ca5d20a5b26315e899e0d22dcf0aa8dbac19f6820f21cf0f",
        "raw_proof_packet": "0f004daf0d8a4a8a3e0bfe8401b810467b220045fc27c6344f0c9623feb75d6faad0b878a7536b1383464b02c130ac4318e392c799add39bca6893459f0f7e781759bf70c2464e1c37ec18a40b460e97a5f1a9ec94c6e2dcfeeaa8ca5d20a5b26315e899e0d22dcf0aa8dbac19f6820f21cf0f",
        "proof_validator_public": "3c83c279c05ac632bb9aad296fa648ac9ba542aa7dc4bb7270d4a3309049c51a",
        "proof_validator_note": "Link.py:189 \u2014 responder: peer_sig_pub_bytes = data[ECPUBSIZE//2:ECPUBSIZE] (initiator ephemeral Ed25519 pub from LINKREQUEST)"
      }
    ]
  }
}
